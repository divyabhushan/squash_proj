Fixing the bug#1234.
Fixed and tested.
